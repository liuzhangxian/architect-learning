3月23日 今日情话：你真漂亮，让我想把我的余额都打到你的卡上。

#### cpu为什么要缓存？
为了充分利用CPU。CPU速度很快，如果要对同一数据操作很多次，把数据放到CPU缓存中，会充分利用CPU，提升程序的速度。从内存取数据需要200多个cpu时间，从缓存取数据只需要1个cpu时间。

#### CPU的3个缓存级别
1. 一级缓存：32K，最快，最小，最近CPU。每个核有一个数据一级缓存和一个指令一级缓存。
2. 二级缓存：256K，比一级缓存慢、更大，每个核有一个二级缓存。
3. 三级缓存：12M，最大的一级，最慢，同一个CPU插槽共享一个三级缓存。
4. CPU获取数据时，先从一级缓存找，取不到再到二级缓存取、三级缓存取，最后到内存取。

#### 缓存的存储单位
 缓存是由64字节的缓存行组成的，每次cpu每次存取数据都是按行为最小操作单位。

#### MESI协议
1. M(修改，Modified)：本地处理器已经修改缓存行, 即是脏行, 它的内容与内存中的内容不一样. 并且此cache只有本地一个拷贝(专有).
2. E(专有，Exclusive)：缓存行内容和内存中的一样, 而且其它处理器都没有这行数据.
3. S(共享，Shared)：缓存行内容和内存中的一样, 有可能其它处理器也存在此缓存行的拷贝.
4. I(无效，Invalid)：缓存行失效, 不能使用.

### 3月24日
悄悄话：入我相思门，知我相思苦，长相思兮长相忆，短相思兮无穷极。想你了，我的宝贝..嘻嘻

#### MESI四种状态的转换的场景
1. 初始态：一开始缓存行没有数据，处于Invalid状态
2. 本地写（Local Write）: 本地处理器写数据到缓存行后，处于Modified状态
3. 本地读（Local Read）: 从内存读取(1)其他处理器没有此行数据则变为Exclusive状态。(2)其他处理器有此行数据则变为Shared状态。
4. 远程读（remote Read）: 本地处理器读取其他处理器的缓存行数据后，处于Shared状态。
5. 远程写（Remote Write）: 本地处理器修改其他处理器的缓存行数据，将其他处理器缓存行远程读到本地缓存行，本地缓存行变成Exclusive，其他处理器缓存行变成Invalid，此时修改本地缓存行即可实现修改远程处理器缓存行。

#### 什么是为共享？