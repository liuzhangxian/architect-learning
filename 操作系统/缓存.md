3月23日

#### cpu为什么要缓存？
为了充分利用CPU。CPU速度很快，如果要对同一数据操作很多次，把数据放到CPU缓存中，会充分利用CPU，提升程序的速度。从内存取数据需要200多个cpu时间，从缓存取数据只需要1个cpu时间。

#### CPU的3个缓存级别
1. 一级缓存：32K，最快，最小，最近CPU。每个核有一个数据一级缓存和一个指令一级缓存。
2. 二级缓存：256K，比一级缓存慢、更大，每个核有一个二级缓存。
3. 三级缓存：12M，最大的一级，最慢，同一个CPU插槽共享一个三级缓存。
4. CPU获取数据时，先从一级缓存找，取不到再到二级缓存取、三级缓存取，最后到内存取。

#### 缓存的存储单位
 缓存是由64字节的缓存行组成的，每次cpu每次存取数据都是按行为最小操作单位。

#### MESI协议
1. M(修改，Modified)：本地处理器已经修改缓存行, 即是脏行, 它的内容与内存中的内容不一样. 并且此cache只有本地一个拷贝(专有).
2. E(专有，Exclusive)：缓存行内容和内存中的一样, 而且其它处理器都没有这行数据.
3. S(共享，Shared)：缓存行内容和内存中的一样, 有可能其它处理器也存在此缓存行的拷贝.
4. I(无效，Invalid)：缓存行失效, 不能使用.

#### MESI四种状态的转换