#### 2020年6月11日 早
@小可爱：我的未来规划里都是你。

#### 行锁
1. 开销大
2. 加锁慢
3. 会出现死锁
4. 锁定粒度小
5. 并发度高
6. 偏向InnoDB存储引擎
7. 发生锁冲突的概率最低

#### InnoDB与MYISAM的最大不同有两点：
1. innoDB支持事务，myisam不支持事务
2. innoDB支持行锁，myisam没有行锁。

#### 并发事务问题
1. 更新丢失：后提交事务覆盖先提交事务处理结果。乐观锁解决。
2. 脏读：读到未提交的数据。
3. 不可重复读：事务A读到了事务B提交的修改数据。
4. 幻读：事务A读到了事务B提交的新增数据。（事务A中修改事务B新增的数据，就能读到事务B中新增的数据了，否则不能读到。因为是快照）。

#### RR和RC的对比
1. 在RR隔离级别下，存在间隙锁，导致出现死锁的几率比RC大的多！
2. 在RR隔离级别下，条件列未命中索引会锁表！而在RC隔离级别下，只锁行
3. 在RC隔离级别下，半一致性读(semi-consistent)特性增加了update操作的并发性！


#### mysql默认RR，sqlserver,oracle默认RC的原因
1. mysql使用binlog使用statement格式时主从复制用RC会有BUG，用RR没BUG。5.1版本后用row格式，RC才没有BUG。


#### MVCC（多版本控制）
1.

#### 总结
1. 用事务注解，一般用RR事务隔离级别，即事务开始后才对数据进行检查。RC可以在事务开始前对数据进行检查。
2. 如果没有乐观锁或排他锁，不要把变量放到java中操作，再设置到数据库中。会出现数据丢失。可重复读事务隔离级别用set i=i+1的方式，不会出现事务丢失。
